{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="{% static 'style.css' %}?v=1.0"> 
    <!-- ?v=1.0 -->

    <title>{% block title %}{% endblock %}</title>
</head>
<body>


            <!-- <nav>
              <a href="/">Home</a> |
              <a href="/about">about</a> |
              <a href="/addproduct">addproduct</a> |
              <a href="/product">product</a> |
              
              {% if 'usersession' in request.session %}
              
              <a href="/logout">logout</a> |
              <a href="/account">account</a> |
              <a href="/cart">mycart</a> |
              <a href="/myorders ">myorders</a> 
              {% else %}
              <a href="/register ">Register</a> |
              <a href="/login"   >Login</a> |  
                
              {% endif %}
          </nav> -->


    <nav class="navbar navbar-expand-lg navbar-light bg-light navcheck">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">TrendMART</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">

            <!-- Search Form (adjustable across screen sizes) -->
            <form class="d-flex me-auto mt-2 mt-lg-0" method="get">
                <input class="form-control me-2" type="search" placeholder="Search for Products..." name="search" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button>
            </form>

            <ul class="navbar-nav ms-auto">
              <!-- Profile Dropdown -->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  <img src="{% static 'profile.png' %}" class="rounded-circle me-2" style="width: 40px;" alt="Profile">
                </a>
                <ul class="dropdown-menu dropdown-menu-end" id="dropdown-menu2" aria-labelledby="navbarDropdown">
                  <li class="px-3 py-2 text-center">
                    <b>Welcome</b><br>
                    <small>To access your account and manage orders</small>
                  </li>
                  <div id="up-in" class="d-flex justify-content-around my-3">
                    {% if 'usersession' in request.session %}
                    <button class="logout btn btn-danger"><a href="/logout" class="text-white text-decoration-none">LOGOUT</a></button>
                    {% else %}
                    <button class="btn btn-primary"><a href="/login" class="text-white text-decoration-none">LOGIN</a></button>
                    <button class="btn btn-secondary"><a href="/register" class="text-white text-decoration-none">SIGN UP</a></button>
                    {% endif %}
                  </div>
                  <li><hr class="dropdown-divider"></li>
                  {% if 'usersession' in request.session %}
                  <li><a class="dropdown-item" href="/account0">Account</a></li>
                  {% endif %}
                  <li><a class="dropdown-item" href="/myorders">Orders</a></li>
                  <li><a class="dropdown-item" href="/wishlist">Wishlist</a></li>
                  <li><a class="dropdown-item" href="#">Gift Cards</a></li>
                  <li><a class="dropdown-item" href="#">Contact Us</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li class="px-3 text-center">
                    <a href="/" class="me-2">Home</a> |
                    <a href="/about" class="me-2">About</a> |
                    <a href="/addproduct" class="me-2">Add Product</a> |
                    <a href="/product" class="me-2">Product</a>
                    {% if 'usersession' in request.session %}
                    <a href="/logout" class="me-2">Logout</a> |
                    <a href="/account" class="me-2">Account</a> |
                    <a href="/cart" class="me-2">My Cart</a> |
                    <a href="/myorders">My Orders</a>
                    {% else %}
                    <a href="/register" class="me-2">Register</a> |
                    <a href="/login" class="me-2">Login</a>
                    {% endif %}
                  </li>
                </ul>
              </li>
              
     <!-- Wishlist Icon -->

<li class="nav-item">
  

{% if wishlist %}
<i class="bi bi-heart-fill"></i>
{% else %}

<i class="bi bi-heart" style="font-size: 2rem;"></i>

{% endif %}
       
       
         
</li>

<!-- Cart Icon with Badge -->
<li class="nav-item cart-container position-relative">
  <a href="/cart" class="nav-link">
    <i class="bi bi-cart cart-icon"></i> <!-- Added cart-icon class for custom sizing -->
    <span id="cart-count" class="badge bg-danger rounded-pill  ">{{ request.session.cart_count|default:0 }}</span>
  </a>
</li>
            </ul>

          </div>
        </div>
      </nav>

      

    <!-- Main content block -->
    <!-- <div class="container-fluid mt-4"> -->
      {% block content %}
      {% endblock %}
    <!-- </div> -->

    <!-- JavaScript -->
    <script src="{% static 'myscripts.js' %}"></script>

    {% comment %} If user is on homepage and not authenticated, redirect any click to /login {% endcomment %}
    {% if request.path == '/' and 'usersession' not in request.session %}
    <script>
      document.addEventListener('click', function (e) {
        try {
          var el = e.target;
          while (el && el !== document.body) {
            if (el.tagName === 'A') {
              var href = el.getAttribute('href');
              if (href === '/login' || href === '/register' || href === '/register/') return; // allow login/register
            }
            if (el.classList && el.classList.contains('no-redirect')) return; // opt-out class
            el = el.parentElement;
          }
        } catch (err) {
          // ignore
        }
        window.location.href = '/login';
      }, {capture: true});
    </script>
    {% endif %}

</body>
</html>
